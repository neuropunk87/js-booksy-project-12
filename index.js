import{a as C,S as K,N as j,P as z,i as w,A as G}from"./assets/vendor-Dp5ubpI5.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const h="https://books-backend.p.goit.global/books";async function T(){return(await C.get(`${h}/category-list`)).data}async function H(e){return(await C.get(`${h}/category`,{params:{category:e}})).data}async function U(){return(await C.get(`${h}/top-books`)).data.flatMap(t=>t.books)}async function V(e){return(await C.get(`${h}/${e}`)).data}const D=document.getElementById("books-list"),F=document.getElementById("books-count"),B=document.getElementById("show-more-btn"),l=document.getElementById("categoriesDropdownBtn"),r=document.getElementById("categoriesDropdownList"),N=document.getElementById("categoriesDropdownSelected"),I=document.querySelector(".sidebar-category-list");let p=[],v=[],S=[],c=0,u=0,y="";const W=768,O=1440,J=10,Q=24,X=4;function A(){return window.innerWidth<W?J:Q}let f=A();window.addEventListener("resize",()=>{const e=A();e!==f&&(f=e,c=Math.min(c,f),P())});async function Y(){p=await T(),N.textContent="Categories",r.innerHTML=`
    <li role="option" tabindex="0" data-idx="0" class="selected">All categories</li>
    ${p.map((e,t)=>`<li role="option" tabindex="0" data-idx="${t+1}">${e.list_name}</li>`).join("")}
  `}function R(){r.classList.add("open"),l.setAttribute("aria-expanded","true"),setTimeout(()=>r.focus(),0)}function g(){r.classList.remove("open"),l.setAttribute("aria-expanded","false")}l.addEventListener("click",e=>{(e.target.closest(".dropdown-arrow-wrap")||e.target===l)&&(r.classList.contains("open")?g():R())});l.addEventListener("keydown",e=>{var t;(e.key==="Enter"||e.key===" "||e.key==="ArrowDown")&&(e.preventDefault(),R(),(t=r.querySelector("li.selected"))==null||t.focus())});r.addEventListener("click",e=>{e.target.tagName==="LI"&&(x(Number(e.target.dataset.idx)),g())});r.addEventListener("keydown",e=>{const t=Array.from(r.querySelectorAll("li"));let o=t.findIndex(i=>i.classList.contains("selected"));e.key==="ArrowDown"&&o<t.length-1&&(e.preventDefault(),t[o].classList.remove("selected"),o++,t[o].classList.add("selected"),t[o].focus()),e.key==="ArrowUp"&&o>0&&(e.preventDefault(),t[o].classList.remove("selected"),o--,t[o].classList.add("selected"),t[o].focus()),(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),x(o),g(),l.focus()),e.key==="Escape"&&(g(),l.focus())});document.addEventListener("mousedown",e=>{!l.contains(e.target)&&!r.contains(e.target)&&g()});function x(e){const t=Array.from(r.querySelectorAll("li"));t.forEach(o=>o.classList.remove("selected")),t[e].classList.add("selected"),N.textContent="Categories",e===0?(y="",k("")):(y=p[e-1].list_name,k(y))}async function k(e=""){e?v=await H(e):v=await U(),S=v,u=S.length,f=A(),c=Math.min(f,u),P()}function Z(e){const{book_image:t,_id:o,author:i,price:n,title:s}=e,d=window.innerWidth;let E;return d>=O?E=15:d<O&&(E=30),`
    <li class="books-item">
      <img class="books-item__img" src="${t}" alt="${s}">
      <div class="books-item__info">
        <h3 class="books-item__title">${M(s,E)}</h3>
        <span class="books-item__price">$${n||"—"}</span>
      </div>
      <div class="books-item__author">${M(i,30)}</div>
      <button type="button" class="books-item__btn" data-id="${o}">Learn More</button>
    </li>
  `}function P(){D.innerHTML=S.slice(0,c).map(Z).join(""),F.textContent=`Showing ${Math.min(c,u)} of ${u}`,c>=u?B.style.display="none":B.style.display="block"}ee();async function ee(){p=await T(),I.innerHTML=`
  <li class="sidebar-category" data-idx="0"">All categories</li>
  ${p.map((e,t)=>`<li class="sidebar-category" data-idx="${t+1}" data-category="${e.list_name}">${e.list_name}</li>`).join("")}
`,I.addEventListener("click",te)}function te(e){if(Number(e.target.dataset.idx)===0)y="",k("");else{const o=e.target.dataset.category;k(o)}}function M(e,t){const o=e.split(" ");let i=[];o.forEach(s=>{i.push(s.charAt(0).toUpperCase()+s.slice(1).toLowerCase())});const n=i.join(" ");return n.length>=t?n.slice(0,t).trim()+"...":n}B.addEventListener("click",()=>{c=Math.min(c+X,u),P()});D.addEventListener("click",async e=>{if(e.target.classList.contains("books-item__btn")){const t=e.target.dataset.id,o=await V(t);window.openBookModal&&typeof window.openBookModal=="function"&&window.openBookModal(o)}});(async function(){await Y(),x(0)})();new K(".swiper",{modules:[j,z],slidesPerView:1,spaceBetween:24,loop:!1,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{768:{slidesPerView:2},1440:{slidesPerView:3}}});const m=document.querySelector(".book-modal-overlay"),_=document.querySelector(".book-modal-close"),oe=document.querySelector("#btn-add"),ne=document.querySelector("#btn-reduce"),L=document.querySelector(".counter"),se=document.querySelector(".add-btn"),re=document.querySelector(".book-modal-buy-btn"),q=document.querySelector(".book-modal-img"),ie=document.querySelector("#book-modal-info"),b=document.querySelector(".book-modal-name"),ae=document.querySelector(".book-modal-author"),ce=document.querySelector(".book-modal-price");let a=0;function le(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}window.openBookModal=function(e){m&&(q.src=e.book_image,q.alt=e.title,b.textContent=le(e.title),ae.textContent=e.author,ce.textContent=`$${e.price||"—"}`,ie.textContent=e.description||"No info",L.textContent="0",a=0,m.classList.add("open"),document.body.style.overflow="hidden",_&&_.focus())};oe.addEventListener("click",()=>{a++,L.textContent=a});ne.addEventListener("click",()=>{a!==0&&(a--,L.textContent=a)});const $=()=>{m.classList.remove("open"),document.body.style.overflow=""};_.addEventListener("click",()=>{$()});document.addEventListener("keydown",e=>{e.key==="Escape"&&$()});m.addEventListener("click",e=>{e.currentTarget===e.target&&$()});se.addEventListener("click",()=>{if(L.textContent==="0"||a===0){w.error({message:"Спочатку візьміть товар",position:"bottomCenter",backgroundColor:"#ad0000",messageColor:"white",closeOnClick:!0});return}const e=localStorage.getItem(b.textContent)||0,t=parseInt(e)+a;localStorage.setItem(b.textContent,t),w.success({message:`Додано в корзину: ${a} (Цього товару в корзині: ${t})`,position:"bottomCenter",backgroundColor:"var(--color-primary)",messageColor:"white",closeOnClick:!0})});re.addEventListener("click",()=>{if((parseInt(localStorage.getItem(b.textContent))||0)===0){w.error({message:"Спочатку візьміть товар",closeOnClick:!0,position:"bottomCenter",backgroundColor:"#ad0000",messageColor:"white"});return}w.success({message:"Дякуємо за покупку!",closeOnClick:!0,position:"bottomCenter",backgroundColor:"var(--color-primary)",messageColor:"white"})});new G(".accordion-container",{duration:300,showMultiple:!0,onOpen:e=>{const t=e.getBoundingClientRect().height;m.scrollBy({top:t,behavior:"smooth"})},onClose:()=>{const e=document.querySelectorAll(".ac");Array.from(e).some(o=>o.classList.contains("is-active"))||m.scrollTo({top:0,behavior:"smooth"})}});
//# sourceMappingURL=index.js.map
