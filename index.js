import{a as y,S as q,N as D,P as T,i as f,A as N}from"./assets/vendor-Dp5ubpI5.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))p(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const b of s.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&p(b)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function p(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const w="https://books-backend.p.goit.global/books";async function R(){return(await y.get(`${w}/category-list`)).data}async function K(e){return(await y.get(`${w}/category`,{params:{category:e}})).data}async function z(){return(await y.get(`${w}/top-books`)).data.flatMap(t=>t.books)}async function j(e){return(await y.get(`${w}/${e}`)).data}const O=document.getElementById("books-list"),G=document.getElementById("books-count"),L=document.getElementById("show-more-btn"),c=document.getElementById("categoriesDropdownBtn"),r=document.getElementById("categoriesDropdownList"),$=document.getElementById("categoriesDropdownSelected");function U(e){return e.split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" ")}let E=[],C=[],v=[],a=0,l=0,h="";const V=768,F=10,H=24,W=4;function S(){return window.innerWidth<V?F:H}let u=S();window.addEventListener("resize",()=>{const e=S();e!==u&&(u=e,a=Math.min(a,u),A())});async function J(){E=await R(),$.textContent="Categories",r.innerHTML=`
    <li role="option" tabindex="0" data-idx="0" class="selected">All categories</li>
    ${E.map((e,t)=>`<li role="option" tabindex="0" data-idx="${t+1}">${e.list_name}</li>`).join("")}
  `}function M(){r.classList.add("open"),c.setAttribute("aria-expanded","true"),setTimeout(()=>r.focus(),0)}function m(){r.classList.remove("open"),c.setAttribute("aria-expanded","false")}c.addEventListener("click",e=>{(e.target.closest(".dropdown-arrow-wrap")||e.target===c)&&(r.classList.contains("open")?m():M())});c.addEventListener("keydown",e=>{var t;(e.key==="Enter"||e.key===" "||e.key==="ArrowDown")&&(e.preventDefault(),M(),(t=r.querySelector("li.selected"))==null||t.focus())});r.addEventListener("click",e=>{e.target.tagName==="LI"&&(_(Number(e.target.dataset.idx)),m())});r.addEventListener("keydown",e=>{const t=Array.from(r.querySelectorAll("li"));let o=t.findIndex(p=>p.classList.contains("selected"));e.key==="ArrowDown"&&o<t.length-1&&(e.preventDefault(),t[o].classList.remove("selected"),o++,t[o].classList.add("selected"),t[o].focus()),e.key==="ArrowUp"&&o>0&&(e.preventDefault(),t[o].classList.remove("selected"),o--,t[o].classList.add("selected"),t[o].focus()),(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),_(o),m(),c.focus()),e.key==="Escape"&&(m(),c.focus())});document.addEventListener("mousedown",e=>{!c.contains(e.target)&&!r.contains(e.target)&&m()});function _(e){const t=Array.from(r.querySelectorAll("li"));t.forEach(o=>o.classList.remove("selected")),t[e].classList.add("selected"),$.textContent="Categories",e===0?(h="",P("")):(h=E[e-1].list_name,P(h))}async function P(e=""){e?C=await K(e):C=await z(),v=C,l=v.length,u=S(),a=Math.min(u,l),A()}function Q(e){return`
    <li class="books-item">
      <img class="books-item__img" src="${e.book_image}" alt="${e.title}">
      <div class="books-item__info">
        <h3 class="books-item__title">${U(e.title)}</h3>
        <span class="books-item__price">$${e.price||"—"}</span>
      </div>
      <div class="books-item__author">${e.author}</div>
      <button type="button" class="books-item__btn" data-id="${e._id}">Learn More</button>
    </li>
  `}function A(){O.innerHTML=v.slice(0,a).map(Q).join(""),G.textContent=`Showing ${Math.min(a,l)} of ${l}`,a>=l?L.style.display="none":L.style.display="block"}L.addEventListener("click",()=>{a=Math.min(a+W,l),A()});O.addEventListener("click",async e=>{if(e.target.classList.contains("books-item__btn")){const t=e.target.dataset.id,o=await j(t);window.openBookModal&&typeof window.openBookModal=="function"&&window.openBookModal(o)}});(async function(){await J(),_(0)})();new q(".swiper",{modules:[D,T],slidesPerView:1,spaceBetween:24,loop:!1,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{768:{slidesPerView:2},1440:{slidesPerView:3}}});const d=document.querySelector(".book-modal-overlay"),B=document.querySelector(".book-modal-close"),X=document.querySelector("#btn-add"),Y=document.querySelector("#btn-reduce"),k=document.querySelector(".counter"),Z=document.querySelector(".add-btn"),ee=document.querySelector(".book-modal-buy-btn"),I=document.querySelector(".book-modal-img"),te=document.querySelector("#book-modal-info"),g=document.querySelector(".book-modal-name"),oe=document.querySelector(".book-modal-author"),ne=document.querySelector(".book-modal-price");let i=0;function se(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}window.openBookModal=function(e){d&&(I.src=e.book_image,I.alt=e.title,g.textContent=se(e.title),oe.textContent=e.author,ne.textContent=`$${e.price||"—"}`,te.textContent=e.description||"No info",k.textContent="0",i=0,d.classList.add("open"),document.body.style.overflow="hidden",B&&B.focus())};X.addEventListener("click",()=>{i++,k.textContent=i});Y.addEventListener("click",()=>{i!==0&&(i--,k.textContent=i)});const x=()=>{d.classList.remove("open"),document.body.style.overflow=""};B.addEventListener("click",()=>{x()});document.addEventListener("keydown",e=>{e.key==="Escape"&&x()});d.addEventListener("click",e=>{e.currentTarget===e.target&&x()});Z.addEventListener("click",()=>{if(k.textContent==="0"||i===0){f.error({message:"Спочатку візьміть товар",position:"bottomCenter",backgroundColor:"#ad0000",messageColor:"white",closeOnClick:!0});return}const e=localStorage.getItem(g.textContent)||0,t=parseInt(e)+i;localStorage.setItem(g.textContent,t),f.success({message:`Додано в корзину: ${i} (Цього товару в корзині: ${t})`,position:"bottomCenter",backgroundColor:"var(--color-primary)",messageColor:"white",closeOnClick:!0})});ee.addEventListener("click",()=>{if((parseInt(localStorage.getItem(g.textContent))||0)===0){f.error({message:"Спочатку візьміть товар",closeOnClick:!0,position:"bottomCenter",backgroundColor:"#ad0000",messageColor:"white"});return}f.success({message:"Дякуємо за покупку!",closeOnClick:!0,position:"bottomCenter",backgroundColor:"var(--color-primary)",messageColor:"white"})});new N(".accordion-container",{duration:300,showMultiple:!0,onOpen:e=>{const t=e.getBoundingClientRect().height;d.scrollBy({top:t,behavior:"smooth"})},onClose:()=>{const e=document.querySelectorAll(".ac");Array.from(e).some(o=>o.classList.contains("is-active"))||d.scrollTo({top:0,behavior:"smooth"})}});
//# sourceMappingURL=index.js.map
